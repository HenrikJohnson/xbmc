<?xml version="1.0" encoding="UTF-8"?>
<scraper framework="1.1" date="2013-05-29">
	<NfoUrl dest="3">
		<RegExp input="$$1" output="&lt;url&gt;http://musicbrainz.org/ws/2/release/\1?inc=recordings+release-groups+artists+labels+ratings&lt;/url&gt;" dest="3">
			<expression>release/(.+)</expression>
		</RegExp>
	</NfoUrl>
	<ResolveIDToUrl dest="3">
		<RegExp input="$$1" output="&lt;url&gt;http://musicbrainz.org/ws/2/release/\1?inc=recordings+release-groups+artists+labels+ratings&lt;/url&gt;" dest="3">
			<expression>(.+)</expression>
		</RegExp>
	</ResolveIDToUrl>

        <!-- input:     $1=query string -->
	<!-- returns:   the url we should use to do the search -->
	<CreateAlbumSearchUrl dest="3">
	  <RegExp input="$$1" output="&lt;url&gt;http://home.henrik.org:7654/cgi-bin/createsearchurl.cgi?type=album&amp;name=\1&amp;artist=$$4&lt;/url&gt;" dest="3">
	    <RegExp input="$$2" output="(\1)" dest="4">
	      <expression clear="yes">(.+)</expression>
	    </RegExp>
	    <expression/>
	  </RegExp>
	</CreateAlbumSearchUrl>

	<!-- input:     $1=html $2=search query -->
	<!-- returns:   results in xml format <results><movie><title>*</title><url>*</url>*#urls<extra>*</extra></movie>*</results> -->
	<GetAlbumSearchResults dest="1">
	  <RegExp input="$$1" output="\1" dest="1">
	    <expression noclean="1"/>
	  </RegExp>
	</GetAlbumSearchResults>

	<GetAlbumDetails dest="3">
		<RegExp input="$$5" output="&lt;details&gt;\1&lt;/details&gt;" dest="3">
			<!--MBID - release-->
			<RegExp input="$$1" output="\1" dest="3">
				<expression>id=&quot;([^&quot;]*)</expression>
			</RegExp>
			<!--MBID - release group-->
			<RegExp input="$$1" output="\1" dest="4">
				<expression>&lt;release-group\stype=&quot;[^&quot;]*&quot;\sid=&quot;([^&quot;]*)&quot;</expression>
			</RegExp>
			<RegExp input="$$1" output="\1" dest="4+">
				<expression>&lt;release-group\sid=&quot;([^&quot;]*)&quot;\stype=&quot;[^&quot;]*&quot;</expression>
			</RegExp>
			<!--Album title-->
			<RegExp input="$$1" output="\1" dest="7">
				<expression trim="1">&lt;release\sid=&quot;[^&quot;]*&quot;&gt;&lt;title&gt;([^&lt;]*)&lt;</expression>
			</RegExp>
			<!--Artist name-->
			<RegExp input="$$1" output="\1" dest="8">
				<expression trim="1">&lt;release\sid=&quot;[^&quot;]*&quot;&gt;&lt;title&gt;[^&lt;]*&lt;.*?&lt;artist\sid=&quot;[^&quot;]*&quot;&gt;&lt;name&gt;([^&lt;]*)&lt;</expression>
			</RegExp>
			<RegExp input="$$3" output="&lt;chain function=&quot;GetMBAlbumTitleByMBID&quot;&gt;\1&lt;/chain&gt;" dest="5">
				<expression noclean="1">(.+)</expression>
			</RegExp>
			<RegExp input="$$3" output="&lt;chain function=&quot;GetMBAlbumArtistsByMBID&quot;&gt;\1&lt;/chain&gt;" dest="5+">
				<expression noclean="1">(.+)</expression>
			</RegExp>
			<RegExp input="$$3" output="&lt;chain function=&quot;GetMBAlbumArtistByMBID&quot;&gt;\1&lt;/chain&gt;" dest="5+">
				<expression noclean="1">(.+)</expression>
			</RegExp>
			<RegExp input="$$3" output="&lt;chain function=&quot;GetMBAlbumLabelByMBID&quot;&gt;\1&lt;/chain&gt;" dest="5+">
				<expression noclean="1">(.+)</expression>
			</RegExp>
			<RegExp input="$$3" output="&lt;chain function=&quot;GetMBAlbumDateByMBID&quot;&gt;\1&lt;/chain&gt;" dest="5+">
				<expression noclean="1">(.+)</expression>
			</RegExp>
			<RegExp input="$$3" output="&lt;chain function=&quot;GetMBAlbumTracksByMBID&quot;&gt;\1&lt;/chain&gt;" dest="5+">
				<expression noclean="1">(.+)</expression>
			</RegExp>
			<RegExp input="$INFO[albumreviewsource]" output="&lt;url function=&quot;GetAMGAlbumReview&quot; cache=&quot;mb-$$4-rg.xml&quot;&gt;http://musicbrainz.org/ws/2/release-group/$$4?inc=url-rels&lt;/url&gt;" dest="5+">
				<expression>allmusic.com</expression>
			</RegExp>
			<RegExp input="$INFO[albumreviewsource]" output="&lt;chain function=&quot;GetTADBAlbumReviewByMBID&quot;&gt;$$4&lt;/chain&gt;" dest="5+">
				<expression>TheAudioDb.com</expression>
			</RegExp>
			<RegExp input="$INFO[albumratingsource]" output="&lt;chain function=&quot;GetMBAlbumRatingByMBID&quot;&gt;$$3&lt;/chain&gt;" dest="5+">
				<expression>MusicBrainz</expression>
			</RegExp>
			<RegExp input="$INFO[albumratingsource]" output="&lt;url function=&quot;GetAMGAlbumRating&quot; cache=&quot;mb-$$4-rg.xml&quot;&gt;http://musicbrainz.org/ws/2/release-group/$$4?inc=url-rels&lt;/url&gt;" dest="5+">
				<expression>allmusic.com</expression>
			</RegExp>
			<RegExp input="$INFO[albumratingsource]" output="&lt;chain function=&quot;GetTADBAlbumRatingByMBID&quot;&gt;$$4&lt;/chain&gt;" dest="5+">
				<expression>TheAudioDb.com</expression>
			</RegExp>
			<RegExp input="$INFO[albumstylessource]" output="&lt;url function=&quot;GetAMGAlbumStyles&quot; cache=&quot;mb-$$4-rg.xml&quot;&gt;http://musicbrainz.org/ws/2/release-group/$$4?inc=url-rels&lt;/url&gt;" dest="5+">
				<expression>allmusic.com</expression>
			</RegExp>
			<RegExp input="$INFO[albumstylessource]" output="&lt;chain function=&quot;GetTADBAlbumStylesByMBID&quot;&gt;$$4&lt;/chain&gt;" dest="5+">
				<expression>TheAudioDb.com</expression>
			</RegExp>
			<RegExp input="$INFO[albummoodssource]" output="&lt;url function=&quot;GetAMGAlbumMoods&quot; cache=&quot;mb-$$4-rg.xml&quot;&gt;http://musicbrainz.org/ws/2/release-group/$$4?inc=url-rels&lt;/url&gt;" dest="5+">
				<expression>allmusic.com</expression>
			</RegExp>
			<RegExp input="$INFO[albummoodssource]" output="&lt;chain function=&quot;GetTADBAlbumMoodsByMBID&quot;&gt;$$4&lt;/chain&gt;" dest="5+">
				<expression>TheAudioDb.com</expression>
			</RegExp>
			<RegExp input="$INFO[albumthemessource]" output="&lt;url function=&quot;GetAMGAlbumThemes&quot; cache=&quot;mb-$$4-rg.xml&quot;&gt;http://musicbrainz.org/ws/2/release-group/$$4?inc=url-rels&lt;/url&gt;" dest="5+">
				<expression>allmusic.com</expression>
			</RegExp>
			<RegExp input="$INFO[albumthemessource]" output="&lt;chain function=&quot;GetTADBAlbumThemeByMBID&quot;&gt;$$4&lt;/chain&gt;" dest="5+">
				<expression>TheAudioDb.com</expression>
			</RegExp>
			<RegExp conditional="fanarttvalbumthumbs" input="$$4" output="&lt;chain function=&quot;GetFanartTvAlbumThumbsByMBID&quot;&gt;\1&lt;/chain&gt;" dest="5+">
				<expression noclean="1">(.+)</expression>
			</RegExp>
			<RegExp conditional="tadbalbumthumbs" input="$$4" output="&lt;chain function=&quot;GetTADBAlbumThumbsByMBID&quot;&gt;\1&lt;/chain&gt;" dest="5+">
				<expression noclean="1">(.+)</expression>
			</RegExp>
			<RegExp conditional="allmusicalbumthumbs" input="$$4" output="&lt;url function=&quot;GetAMGAlbumThumbs&quot; cache=&quot;mb-\1-rg.xml&quot;&gt;http://musicbrainz.org/ws/2/release-group/\1?inc=url-rels&lt;/url&gt;" dest="5+">
				<expression noclean="1">(.+)</expression>
			</RegExp>
			<expression noclean="1" />
		</RegExp>
	</GetAlbumDetails>

	<GetAMGAlbumReview dest="5">
		<RegExp input="$$2" output="&lt;details&gt;\1&lt;/details&gt;" dest="5">
			<RegExp input="$$1" output="&lt;chain function=&quot;GetAMGAlbumReviewByAMGID&quot;&gt;\1&lt;/chain&gt;" dest="2">
				<expression noclean="1">allmusic.com/album/([^&lt;]*)</expression>
			</RegExp>
			<expression noclean="1" />
		</RegExp>
	</GetAMGAlbumReview>

	<GetAMGAlbumRating dest="5">
		<RegExp input="$$2" output="&lt;details&gt;\1&lt;/details&gt;" dest="5">
			<RegExp input="$$1" output="&lt;chain function=&quot;GetAMGAlbumRatingByAMGID&quot;&gt;\1&lt;/chain&gt;" dest="2">
				<expression noclean="1">allmusic.com/album/([^&lt;]*)</expression>
			</RegExp>
			<expression noclean="1" />
		</RegExp>
	</GetAMGAlbumRating>

	<GetAMGAlbumStyles dest="5">
		<RegExp input="$$2" output="&lt;details&gt;\1&lt;/details&gt;" dest="5">
			<RegExp input="$$1" output="&lt;chain function=&quot;GetAMGAlbumStylesByAMGID&quot;&gt;\1&lt;/chain&gt;" dest="2">
				<expression noclean="1">allmusic.com/album/([^&lt;]*)</expression>
			</RegExp>
			<expression noclean="1" />
		</RegExp>
	</GetAMGAlbumStyles>

	<GetAMGAlbumMoods dest="5">
		<RegExp input="$$2" output="&lt;details&gt;\1&lt;/details&gt;" dest="5">
			<RegExp input="$$1" output="&lt;chain function=&quot;GetAMGAlbumMoodsByAMGID&quot;&gt;\1&lt;/chain&gt;" dest="2">
				<expression noclean="1">allmusic.com/album/([^&lt;]*)</expression>
			</RegExp>
			<expression noclean="1" />
		</RegExp>
	</GetAMGAlbumMoods>

	<GetAMGAlbumThemes dest="5">
		<RegExp input="$$2" output="&lt;details&gt;\1&lt;/details&gt;" dest="5">
			<RegExp input="$$1" output="&lt;chain function=&quot;GetAMGAlbumThemesByAMGID&quot;&gt;\1&lt;/chain&gt;" dest="2">
				<expression noclean="1">allmusic.com/album/([^&lt;]*)</expression>
			</RegExp>
			<expression noclean="1" />
		</RegExp>
	</GetAMGAlbumThemes>

	<GetAMGAlbumThumbs dest="5">
		<RegExp input="$$2" output="&lt;details&gt;\1&lt;/details&gt;" dest="5">
			<RegExp input="$$1" output="&lt;chain function=&quot;GetAMGAlbumThumbsByAMGID&quot;&gt;\1&lt;/chain&gt;" dest="2">
				<expression noclean="1">allmusic.com/album/([^&lt;]*)</expression>
			</RegExp>
			<expression noclean="1" />
		</RegExp>
	</GetAMGAlbumThumbs>

</scraper>
